"0","library(keras)"
"0","library(mlr)"
"0","library(tensorflow)"
"0",""
"0","# Crear variables one-hot para la variable de salida"
"0","data_tn2$BH.staging.1 <- as.integer(data_tn2$BH.staging == ""F1"")"
"0","data_tn2$BH.staging.2 <- as.integer(data_tn2$BH.staging == ""F2"")"
"0","data_tn2$BH.staging.3 <- as.integer(data_tn2$BH.staging == ""F3"")"
"0","data_tn2$BH.staging.4 <- as.integer(data_tn2$BH.staging == ""F4"")"
"0",""
"0","data_tn2 <- data_tn2 %>% "
"0","  select(-BH.staging)"
"0",""
"0","# Convertir a matriz y variables one-hot"
"0","set.seed(161121)"
"0","nc <- ncol(data_tn2)"
"0","x_train <- as.matrix(data_tn2[, 1:nc])"
"0","y_train <- as.matrix(data_tn2[, c(""BH.staging.1"", ""BH.staging.2"", ""BH.staging.3"", ""BH.staging.4"")])"
"0",""
"0","tf$random$set_seed(777)"
"0","# Crear modelo secuencial"
"0","modelo_sfg <- keras_model_sequential() %>%"
"0","  layer_dense(units = 32, activation = ""relu"", input_shape = c(nc)) %>%"
"0","  layer_dropout(rate = 0.5) %>%"
"0","  layer_dense(units = 16, activation = ""relu"") %>%"
"0","  layer_dropout(rate = 0.5) %>%"
"0","  layer_dense(units = 4, activation = ""softmax"")"
"0",""
"0","# Compilar modelo"
"0","#learning_rate <- c(0.001, 0.01, 0.1)"
"0",""
"0","learning_rate <- 0.0001"
"0",""
"0","tf$random$set_seed(777)"
"0","modelo_sfg %>% compile("
"0","  optimizer = optimizer_adam(learning_rate),"
"0","  loss = ""categorical_crossentropy"","
"0","  metrics = ""accuracy"""
"0",")"
"0",""
"0","#tf$random$set_seed(777)"
"0","  # Entrenar el modelo"
"0","history <- modelo_sfg %>% fit("
"0","  x = x_train,"
"0","  y = y_train,"
"0","  epochs = 47,"
"0","  batch_size = 32,"
"0","  validation_split = 0.2,"
"0","  verbose = 0"
"0",")"
"0",""
"0","plot(history)"
